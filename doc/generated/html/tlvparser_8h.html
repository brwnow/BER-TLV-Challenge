<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BTLV Lib: src/include/tlvparser.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BTLV Lib
   &#160;<span id="projectnumber">0.0.3</span>
   </div>
   <div id="projectbrief">Lib handful for encoding or decoding BER-TLV data objects</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b0856f6b0d80ccb263b2f415c91f9e17.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">tlvparser.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Core header for parsing specific TLV objects fields.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="bertlv_8h_source.html">bertlv.h</a>&quot;</code><br />
</div>
<p><a href="tlvparser_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af2b0501c8a8887b3e4ecba229bc45029"><td class="memItemLeft" align="right" valign="top"><a id="af2b0501c8a8887b3e4ecba229bc45029"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TAG_CLASS_MASK</b>&#160;&#160;&#160;0xC0</td></tr>
<tr class="separator:af2b0501c8a8887b3e4ecba229bc45029"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed1858f21f2eed9c3b0bb77587f2683a"><td class="memItemLeft" align="right" valign="top"><a id="aed1858f21f2eed9c3b0bb77587f2683a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TAG_TYPE_MASK</b>&#160;&#160;&#160;0x20</td></tr>
<tr class="separator:aed1858f21f2eed9c3b0bb77587f2683a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80df650b3974c09e598e760187ebfde8"><td class="memItemLeft" align="right" valign="top"><a id="a80df650b3974c09e598e760187ebfde8"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TAG_NUMBER_MASK</b>&#160;&#160;&#160;0x1F</td></tr>
<tr class="separator:a80df650b3974c09e598e760187ebfde8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab28ba4f7487ad2bbf811d598731673be"><td class="memItemLeft" align="right" valign="top"><a id="ab28ba4f7487ad2bbf811d598731673be"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TAG_CLASS_SHIFT</b>&#160;&#160;&#160;6</td></tr>
<tr class="separator:ab28ba4f7487ad2bbf811d598731673be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae26630cf5003c6fc00592d3df4508625"><td class="memItemLeft" align="right" valign="top"><a id="ae26630cf5003c6fc00592d3df4508625"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TAG_TYPE_SHIFT</b>&#160;&#160;&#160;5</td></tr>
<tr class="separator:ae26630cf5003c6fc00592d3df4508625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d3a96d86bedd115e9f8bc9ea581ebce"><td class="memItemLeft" align="right" valign="top"><a id="a8d3a96d86bedd115e9f8bc9ea581ebce"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TAG_GET_CLASS</b>(tag)&#160;&#160;&#160;(((tag)&amp;TAG_CLASS_MASK) &gt;&gt; TAG_CLASS_SHIFT)</td></tr>
<tr class="separator:a8d3a96d86bedd115e9f8bc9ea581ebce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e4471eb0942338d32b683e52e3199e4"><td class="memItemLeft" align="right" valign="top"><a id="a0e4471eb0942338d32b683e52e3199e4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TAG_GET_TYPE</b>(tag)&#160;&#160;&#160;(((tag)&amp;TAG_TYPE_MASK) &gt;&gt; TAG_TYPE_SHIFT)</td></tr>
<tr class="separator:a0e4471eb0942338d32b683e52e3199e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41519a72fc57ed37afbb5fde46ed9d9e"><td class="memItemLeft" align="right" valign="top"><a id="a41519a72fc57ed37afbb5fde46ed9d9e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TAG_GET_NUMBER</b>(tag)&#160;&#160;&#160;((tag)&amp;TAG_NUMBER_MASK)</td></tr>
<tr class="separator:a41519a72fc57ed37afbb5fde46ed9d9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2033d0269f92f861a9cc5dd3c1ca3f45"><td class="memItemLeft" align="right" valign="top"><a id="a2033d0269f92f861a9cc5dd3c1ca3f45"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TAG_SUBSEQUENT_NUMBER</b>&#160;&#160;&#160;0x1F</td></tr>
<tr class="separator:a2033d0269f92f861a9cc5dd3c1ca3f45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adea959b79fecce28976fd32f64887bc0"><td class="memItemLeft" align="right" valign="top"><a id="adea959b79fecce28976fd32f64887bc0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>TAG_HAS_SUBSEQUENT_BYTE</b>(tag)&#160;&#160;&#160;(((tag)&amp;TAG_NUMBER_MASK) == TAG_SUBSEQUENT_NUMBER)</td></tr>
<tr class="separator:adea959b79fecce28976fd32f64887bc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a440106b9c8b5c721720d8864bbbda047"><td class="memItemLeft" align="right" valign="top"><a id="a440106b9c8b5c721720d8864bbbda047"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>LENGTH_HEADING_BYTE_MASK</b>&#160;&#160;&#160;0x80</td></tr>
<tr class="separator:a440106b9c8b5c721720d8864bbbda047"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71aa9b39e821befb0a1a679fcc779772"><td class="memItemLeft" align="right" valign="top"><a id="a71aa9b39e821befb0a1a679fcc779772"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>LENGTH_HEADING_BYTE_VAL_MASK</b>&#160;&#160;&#160;0x7F</td></tr>
<tr class="separator:a71aa9b39e821befb0a1a679fcc779772"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71c15c04ab6ec83eb27bbbdc7094266f"><td class="memItemLeft" align="right" valign="top"><a id="a71c15c04ab6ec83eb27bbbdc7094266f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>LENGTH_HAS_SUBSEQUENT_BYTES</b>(headingByte)&#160;&#160;&#160;((headingByte)&amp;LENGTH_HEADING_BYTE_MASK)</td></tr>
<tr class="separator:a71c15c04ab6ec83eb27bbbdc7094266f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a773d6dc9b4c527342acbbb820f256032"><td class="memItemLeft" align="right" valign="top"><a id="a773d6dc9b4c527342acbbb820f256032"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>LENGTH_GET_SUBSEQUENT_BYTES_COUNT</b>(headingByte)&#160;&#160;&#160;((headingByte)&amp;LENGTH_HEADING_BYTE_VAL_MASK)</td></tr>
<tr class="separator:a773d6dc9b4c527342acbbb820f256032"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9352a3f9c54c1efc8aa8eacf0c776fad"><td class="memItemLeft" align="right" valign="top"><a id="a9352a3f9c54c1efc8aa8eacf0c776fad"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>BYTE_SHIFT_LEFT</b>(X)&#160;&#160;&#160;((X) &lt;&lt; 8)</td></tr>
<tr class="separator:a9352a3f9c54c1efc8aa8eacf0c776fad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7a968a7490a132a7d26a3078f4e48f34"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bertlv_8h.html#a0f22ff95c3eff0ff70b6e40823240e6b">BTLV_ReturnCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tlvparser_8h.html#a7a968a7490a132a7d26a3078f4e48f34">BTLV_tagFieldParse</a> (const uint8_t *const tlvObjectBuffer, const size_t objectBufferSize, <a class="el" href="bertlv_8h.html#a848cfb2882e69cd6101383f49f7d747d">BTLV_DataObject</a> *const dataElement)</td></tr>
<tr class="memdesc:a7a968a7490a132a7d26a3078f4e48f34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses the TAG field of a BER-TLV element.  <a href="#a7a968a7490a132a7d26a3078f4e48f34">More...</a><br /></td></tr>
<tr class="separator:a7a968a7490a132a7d26a3078f4e48f34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0dd88bf2aa627c400c9a5ad30a92b20"><td class="memItemLeft" align="right" valign="top"><a class="el" href="bertlv_8h.html#a0f22ff95c3eff0ff70b6e40823240e6b">BTLV_ReturnCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="tlvparser_8h.html#ac0dd88bf2aa627c400c9a5ad30a92b20">BTLV_lengthFieldParse</a> (const uint8_t *const tlvObjectBuffer, const size_t objectBufferSize, size_t *const length, size_t *const lengthFieldByteCount)</td></tr>
<tr class="memdesc:ac0dd88bf2aa627c400c9a5ad30a92b20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses the Length field of a BER-TLV element.  <a href="#ac0dd88bf2aa627c400c9a5ad30a92b20">More...</a><br /></td></tr>
<tr class="separator:ac0dd88bf2aa627c400c9a5ad30a92b20"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Core header for parsing specific TLV objects fields. </p>
<p>Not recommended to use this API directly</p>
<p>You'd better use only <a class="el" href="bertlv_8h.html" title="BER-TLV objects encoding/decoding API. ">bertlv.h</a> header and its exposed API. This file and its functions are core functions for BTLV Lib working. Only use this directly if quite needed. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a7a968a7490a132a7d26a3078f4e48f34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a968a7490a132a7d26a3078f4e48f34">&#9670;&nbsp;</a></span>BTLV_tagFieldParse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bertlv_8h.html#a0f22ff95c3eff0ff70b6e40823240e6b">BTLV_ReturnCode</a> BTLV_tagFieldParse </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *const&#160;</td>
          <td class="paramname"><em>tlvObjectBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>objectBufferSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bertlv_8h.html#a848cfb2882e69cd6101383f49f7d747d">BTLV_DataObject</a> *const&#160;</td>
          <td class="paramname"><em>dataElement</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses the TAG field of a BER-TLV element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tlvObjectBuffer</td><td>The address of the BER-TLV data object block of bytes in memory. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">objectBufferSize</td><td>Size of the data object block of bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dataElement</td><td>A BTLV_DataObject struct which to fill the fields related to TAG field</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns BTLV_RET_OK on success. </dd>
<dd>
Returns BTLV_INVALID_PARAMETER if some problem is found on given arguments. </dd>
<dd>
Returns BTLV_BAD_TLV_ENCODING if input TLV object byte block is bad encoded and the function fails to extract TAG field properties. </dd></dl>

</div>
</div>
<a id="ac0dd88bf2aa627c400c9a5ad30a92b20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0dd88bf2aa627c400c9a5ad30a92b20">&#9670;&nbsp;</a></span>BTLV_lengthFieldParse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="bertlv_8h.html#a0f22ff95c3eff0ff70b6e40823240e6b">BTLV_ReturnCode</a> BTLV_lengthFieldParse </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *const&#160;</td>
          <td class="paramname"><em>tlvObjectBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>objectBufferSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *const&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *const&#160;</td>
          <td class="paramname"><em>lengthFieldByteCount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses the Length field of a BER-TLV element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tlvObjectBuffer</td><td>The address of the BER-TLV data object block of bytes in memory. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">objectBufferSize</td><td>Size of the data object block of bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">length</td><td>Output parameter to return the extracted length of the BER-TLV element. When its detected that there is subsequent bytes, this parameter is cleaned to 0. If it fails parsing the length field, it will return 0. This parameter may be returned truncated if the BER-TLV data object has more bytes in length field that a size_t can hold. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">lengthFieldByteCount</td><td>The amount of bytes of parsed length field, including the first byte that indicates the length of length field in cases the first byte has the most significant bit set on. Byte counting don't stop when an overflow occurs. It only stops if buffer limit is reached.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns BTLV_RET_OK on success. </dd>
<dd>
Returns BTLV_INVALID_PARAMETER if some problem is found on given arguments. </dd>
<dd>
Returns BTLV_BAD_TLV_ENCODING if input TLV object byte block is bad encoded and the function fails to extract LENGTH field properties. Generally it occurs when buffer size is not enough to parse the data that is supposed to be encoded (length field tells it has more subsequent bytes than buffer size indicates). When this occurs, returned data must be discard and the parsing must fail. </dd>
<dd>
Returns BTLV_TYPE_OVERFLOW if an overflow occur during extraction of length field. The length is return anyway, but truncated. The byte count ignores overflow and return the amount of byte encoded. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Oct 11 2021 03:48:10 for BTLV Lib by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
